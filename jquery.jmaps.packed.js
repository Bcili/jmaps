/* jQuery Maps (jmaps) - A jQuery plugin for Google Maps API
 * Author: Tane Piper (digitalspaghetti at gmail dot com) 
 * With special thanks Dave Cardwell (who helped on getting the first version of this plugin to work).
 * Website: http://code.google.com/p/jmaps/
 * Licensed under the MIT License: http://www.opensource.org/licenses/mit-license.php
 * This plugin is not affiliated with Google or Yahoo.  
 * For Google Maps API and T&C see http://www.google.com/apis/maps/
 * For Yahoo! Maps API and T&C see http://developer.yahoo.com/maps/
 * For support, I can usually be found on the #jquery IRC channel on irc.freenode.net
 * ===============================================================================================================
 */
(function($){function searchAddress(c,d,f){if(c._mapType){c.geoCodeAddress(d);YEvent.Capture(c,EventsList.onEndGeoCode,function(e){if(e.success==0){alert(d+" not found")}else{point=new YGeoPoint(e.GeoPoint.Lat,e.GeoPoint.Lon);c.drawZoomAndCenter(point,f.zoom);var a=new YMarker(point);a.openSmartWindow("Latitude: "+point.Lat+"<br />Longitude: "+point.Lon);c.addOverlay(a)}})}else if(c.i.Au){GGeocoder=new GClientGeocoder();GGeocoder.getLatLng(d,function(a){if(!a){alert(d+" not found")}else{c.setCenter(a,f.zoom);var b=new GMarker(a,{draggable:true});c.addOverlay(b);pointlocation=b.getPoint();b.openInfoWindowHtml("Latitude: "+pointlocation.lat()+"<br />Longitude: "+pointlocation.lng());GEvent.addListener(b,"dragend",function(){mylocation=b.getPoint();b.openInfoWindowHtml("Latitude: "+pointlocation.lat()+"<br />Longitude: "+pointlocation.lng())})}})}else{alert('Map Object Not Found!')}}function searchDirections(a,b,c){if(a._mapType){alert('Yahoo Maps Do Not Support Directions')}else if(a.i.Au){var d=document.getElementById(c);directions=new GDirections(a,d);directions.load(b)}}$.fn.extend({jmap:function(e){var f="1.3";var e=jQuery.extend({provider:"google",maptype:"hybrid",center:[55.958858,-3.162302],zoom:12,controlsize:"small",showtype:true,showzoom:true,showpan:true,showoverview:true,showscale:true,dragging:true,scrollzoom:false,smoothzoom:true,searchfield:"#Address",searchbutton:"#findaddress",directionsto:"#to",directionsfrom:"#from",directionsfind:"#getDirections",directionspanel:"myDirections"},e);return this.each(function(){switch(e.provider){case"yahoo":var c=this.jMap=new YMap(this);switch(e.maptype){case"map":var d=YAHOO_MAP_REG;break;case"sat":var d=YAHOO_MAP_SAT;break;default:var d=YAHOO_MAP_HYB;break}c.setMapType(d);c.drawZoomAndCenter(new YGeoPoint(e.center[0],e.center[1]),e.zoom);if(e.showtype==true){c.addTypeControl()}if(e.showzoom==true&&e.controlsize=="small"){c.addZoomShort()}if(e.showzoom==true&&e.controlsize=="large"){c.addZoomLong()}if(e.showpan==true){c.addPanControl()}if(e.showscale==false){c.removeZoomScale()}if(e.dragging==false){c.disableDragMap()}if(e.scrollzoom==false){c.disableKeyControls()}break;case"mslive":alert('Microsoft Live Maps are currently not supported but planned for version 1.4')break;default:var c=this.jMap=new GMap2(this);switch(e.maptype){case"map":var d=G_NORMAL_MAP;break;case"sat":var d=G_SATELLITE_MAP;break;default:var d=G_HYBRID_MAP;break}c.setCenter(new GLatLng(e.center[0],e.center[1]),e.zoom,d);switch(e.controlsize){case"small":c.addControl(new GSmallMapControl());break;case"large":c.addControl(new GLargeMapControl());break;case"none":break;default:c.addControl(new GSmallMapControl())}if(e.showtype==true){c.addControl(new GMapTypeControl())}if(e.showoverview==true){c.addControl(new GOverviewMapControl())}if(e.scrollzoom==true){c.enableScrollWheelZoom()}if(e.smoothzoom==true){c.enableContinuousZoom()}if(e.dragging==false){c.disableDragging()}}jQuery(e.searchbutton).bind('click',function(){searchAddress(c,jQuery(e.searchfield).attr('value'),e)});jQuery(e.directionsfind).bind("click",function(){var a=$(e.directionsfrom).attr('value');var b=$(e.directionsto).attr('value');searchDirections(c,"from: "+a+" to: "+b,e.directionspanel);$(e.directionsfrom).attr('value',b);$(e.directionsto).attr('value','');return false});jQuery(document).unload(function(){GUnload()})})},myMap:function(){return this[0].jMap},addPoint:function(a,b,c,d,f){var g=this[0].jMap;if(g._mapType){var h=new YMarker(new YGeoPoint(a,b));YEvent.Capture(h,EventsList.MouseClick,function(){h.openSmartWindow(c)});if(f==true){YEvent.Capture(h,EventsList.MouseDoubleClick,function(e){g.removeOverlay(h)})}g.addOverlay(h)}else if(g.i.Au){var h=new GMarker(new GLatLng(a,b),{draggable:d});GEvent.addListener(h,"click",function(){h.openInfoWindowHtml(c)});if(f==true){GEvent.addListener(h,"dblclick",function(){return g.removeOverlay(h)})}return g.addOverlay(h)}},addPoly:function(a,b,c,d){var e=this[0].jMap;if(e._mapType){return e.addOverlay(a,b,c,d)}else if(e.i.Au){return e.addOverlay(a)}},addRss:function(a){var b=this[0].jMap;if(b._mapType){var c=new YGeoRSS(a);return b.addOverlay(c)}else if(b.i.Au){var c=new GGeoXml(a);return b.addOverlay(c)}}})})(jQuery);